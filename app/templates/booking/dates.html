<head>
    <!-- Остальные метатеги и стили -->
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
</head>
<style>
    /* Обновленный стиль для календаря */
    body {
        background-color: #1d1d1d;
        color: #fff;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }

    .container {
        margin-top: 10vh;
        padding: 20px;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        background-color: #2f2f32;
        border-radius: 10px;
        box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.5);
        color: #fff;
    }

    /* Стили для календаря */
    .calendar {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
        background-color: #343a40;
        border-radius: 10px;
        padding: 20px;
        box-shadow: rgba(0, 0, 0, 0.25) 0 7px 15px 0;
    }

    .calendar-button {
        width: 50px;
        height: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #4caf50;
        color: #fff;
        font-size: 18px;
        font-weight: bold;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .calendar-button:hover {
        background-color: #81c784;
        transform: scale(1.1);
    }

    .calendar-button:disabled {
        background-color: #9e9e9e;
        cursor: not-allowed;
    }

    .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        margin-bottom: 10px;
        font-size: 20px;
        font-weight: bold;
    }

    .calendar-navigation {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .calendar-nav-button {
        background-color: #0d6efd;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .calendar-nav-button:hover {
        background-color: #539bf5;
    }

    .calendar-title {
        text-align: center;
        flex-grow: 1;
    }

    .time-buttons {
        margin-top: 20px;
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
    }

    .time-button {
        background-color: #ffc107;
        color: #2f2f32;
        border-radius: 5px;
        padding: 10px 15px;
        font-size: 16px;
        font-weight: bold;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .time-button:hover {
        background-color: #ffecb3;
        transform: scale(1.1);
    }

    .alert {
        margin-top: 20px;
        padding: 15px;
        background-color: #f44336;
        color: white;
        border-radius: 5px;
        text-align: center;
    }

    .alert .btn-close {
        background: none;
        border: none;
        color: white;
        font-size: 16px;
        cursor: pointer;
        margin-left: 10px;
        transition: all 0.3s ease;
    }

    .alert .btn-close:hover {
        color: #ffcccc;
    }

</style>
<body>
<nav class="navbar">
    <a href="/book_record/category/services/{{ service_id }}" class="back-button">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left"
             viewBox="0 0 16 16">
            <path fill-rule="evenodd"
                  d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
        </svg>
    </a>
    <h3>Выбрать Дату</h3>
</nav>
<div class="container" id="containerId">
    <div class="mb-3" id="mb3Id">
        <label class="form-label" for="idDateInput">Выберите дату записи</label>
        <input name="date" class="form-control" id="idDateInput" style="color: #f8f8f8;">
        <div id="liveAlertPlaceholder"></div>
    </div>
    <div id="timeContainer"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script>
    // Инициализация Flatpickr
    document.addEventListener('DOMContentLoaded', function () {
        const dateInput = document.getElementById('idDateInput');
        const today = new Date();

        flatpickr(dateInput, {
            minDate: today,
            dateFormat: "Y-m-d",
            onChange: function (selectedDates, dateStr, instance) {
                // Обработка изменения даты
                selectDate();
            },
            locale: "ru" // Локализация календаря
        });

        // Загрузка времени при загрузке страницы
        selectDate();
    });

    // Остальной JavaScript-код для получения времени
    const selectDate = async () => {
        let dateId = document.getElementById('idDateInput').value.trim();

        console.log(`Выбранная дата: ${dateId}`);

        const response = await getTimes(staffId, dateId);
        let times = await response.json();

        console.log(times.available_times);

        if (times.available_times && times.available_times.length !== 0) {
            await viewTimes(times.available_times, dateId);
        } else {
            const mb3 = document.getElementById('timeContainer');

            const wrapper = document.createElement('div');
            wrapper.innerHTML = [
                `<div class="alert alert-primary alert-dismissible" role="alert">`,
                `   <div>Для выбранной даты отсутсвует время для записи.</div>`,
                '   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',
                '</div>'
            ].join('');
            mb3.textContent = '';
            mb3.append(wrapper);

            console.log("Время записи отсутствует");
        }
    };
</script>
</body>
